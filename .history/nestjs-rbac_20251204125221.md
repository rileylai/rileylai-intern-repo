# Role-Based Authorization (RBAC) in NestJS
This document answers all questions from the RBAC onboarding task.

---

## üîç Research & Learn

### **1. How does Auth0 store and manage user roles?**
Auth0 stores user roles inside:
- The **Authorization Core** (built-in roles system)
- The **user's metadata**
- The **access token**, included as custom claims (e.g., `https://example.com/roles: ["admin"]`)

Roles can be assigned to users through the Auth0 dashboard or programmatically.  
The backend reads the access token to determine what permissions a user has.

---

### **2. What is the purpose of a guard in NestJS?**
A guard:
- Determines whether a request is **allowed to proceed**  
- Runs **before** controllers  
- Checks authentication, roles, permissions, or custom logic  
- Returns `true` to allow access or throws an error to block the user  

Guards are the main way NestJS handles authorization and access control.

---

### **3. How would you restrict access to an API endpoint based on user roles?**
Typical approach:
1. Extract roles from the Auth0 access token (via JWT)  
2. Implement a custom `RolesGuard` that checks whether the user‚Äôs roles include the required one  
3. Use a decorator like `@Roles('admin')` on the endpoint  
4. If the user lacks the role, the guard throws a `ForbiddenException`

This ensures only authorized users can access sensitive functionality.

---

### **4. What are the security risks of improper authorization, and how can they be mitigated?**
Risks:
- Unauthorized access to admin-level features  
- Data exposure or modification  
- Escalation of privileges  
- Compliance violations  

Mitigations:
- Validate roles **server-side** (never trust frontend)  
- Use guards for every protected route  
- Validate and verify JWT tokens  
- Avoid hardcoding roles‚Äîuse centralized logic  
- Log authorization failures for auditing  

Strong RBAC is essential for protecting user data and backend integrity.

---

## üõ†Ô∏è Tasks

### **5. Research Auth0 RBAC**
I learned how Auth0 stores roles and attaches them to JWT tokens.

### **6. Retrieve roles from access token**
I reviewed how NestJS decodes Auth0 JWTs to extract role claims.

### **7. Implement RolesGuard**
I studied how to enforce RBAC using guards and custom decorators.

### **8. Protect API endpoint**
I reviewed how to restrict an endpoint so only admins can access it.